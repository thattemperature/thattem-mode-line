#+TITLE: thattem-mode-line
#+AUTHOR: That Temperature
#+EMAIL: 2719023332@qq.com
#+LANGUAGE: en
#+OPTIONS: toc:t num:nil

:BADGE:
[[https://www.gnu.org/licenses/gpl-3.0][file:https://img.shields.io/badge/license-GPL%20v3-blue.svg]]
:END:

#+attr_html: :width 512px :align center
[[file:assets/logo.svg]]

* üåà A Beautiful, Interactive Mode-Line for Emacs

[[https://github.com/thattemperature/thattem-mode-line][thattem-mode-line]] replaces the default Emacs mode-line and header-line
with a modern, visually rich design that combines aesthetic appeal
with practical productivity. Built with [[https://github.com/rainstormstudio/nerd-icons.el][nerd-icons]] and featuring a
full-color, theme-aware palette, it transforms your Emacs into a
polished, interactive workspace.

* ‚ú® Features

** Decorative Elements
- Half-circle ‚Äúcups‚Äù, triangular ‚Äúslants‚Äù, and flame icons as
  Powerline-style separators.
- All icons are drawn with nerd-icons and adapt to the active/inactive
  window state.

** Interactive Components

*** Buffer Name
- Click to copy the buffer name to the kill-ring.
- Mouse-wheel scroll to cycle through previous/next buffers.
- File-type icon (when the buffer is visiting a file).

*** Major-Mode Area
- Mouse-1: pop-up menu of active /local/ minor modes.
- Mouse-2: describe the current major mode.
- Mouse-3: pop-up menu of active /global/ minor modes.

*** Project Name (requires [[https://github.com/bbatsov/projectile][projectile]])
- Mouse-1: open the project‚Äôs root directory in Dired.
- Mouse-wheel: cycle through project buffers.

*** Directory Path
- Each path component is a clickable button that opens Dired at that
  directory.
- Mouse-3 on a component shows a menu of its sub-directories.
- Mouse-wheel scrolls the path horizontally when it overflows.

*** Flymake Diagnostics
- Error, warning, and note counters with distinct colors.
- Mouse-wheel scrolls through the diagnostics of each type.

*** Line & Column Numbers
- Mouse-wheel scrolls lines (up/down) and characters (left/right).

** Theme Support
- Separate, customizable color sets for light and dark themes.
- Inactive windows automatically switch to a subdued palette.
- Faces are defined so you can easily tweak the colors via
  ~customize~.

** Smart Layouts
- /Shell-like buffers/ (term, shell, eshell) get a special header-line
  with flame separators and a reduced font size.
- /Help buffers/ show only line/column numbers and a slant separator.
- /EAF buffers/ use the default format.
- The mode-line adapts to window width: some elements (e.g., detailed
  Flymake icons) appear only when the window is wide enough.

* üì¶ Requirements

- Emacs ‚â• 30.1
- [[https://github.com/rainstormstudio/nerd-icons.el][nerd-icons]]
- [[https://github.com/bbatsov/projectile][projectile]] (optional, for project name)
- [[https://github.com/flymake/flymake][flymake]] (optional, for diagnostics)
- [[https://github.com/rejeep/dash.el][dash]]
- [[https://github.com/rejeep/f.el][f]]

* üîß Installation

** Manual Installation

Clone the repository:

#+begin_src sh
  git clone https://github.com/thattemperature/thattem-mode-line.git
#+end_src

Add to your ~load-path~ and require the package:

#+begin_src elisp
  (add-to-list 'load-path "/path/to/thattem-mode-line")
  (require 'thattem-mode-line)
#+end_src

Then enable the global minor mode:

#+begin_src elisp
  (thattem-mode-line-mode 1)
#+end_src

** Using ~straight.el~ or ~quelpa~

If you use a package manager that supports Git sources, you can
install directly from the repository.

Example with ~straight.el~:

#+begin_src elisp
  (straight-use-package '(thattem-mode-line
                          :type git
                          :host github
                          :repo "thattemperature/thattem-mode-line"))
  (thattem-mode-line-mode 1)
#+end_src

* üé® Configuration

All customizable options are under the ~thattem-mode-line~ group. To
change them, use ~M-x customize-group RET thattem-mode-line RET~ or
set them in your init file.

** Colors

The package defines some color variables that control the background
and foreground of the mode-line.

- ~thattem-mode-line/light-theme/bright-color~
- ~thattem-mode-line/light-theme/dark-color~
- ~thattem-mode-line/dark-theme/bright-color~
- ~thattem-mode-line/dark-theme/dark-color~
- ‚Ä¶ and so on.

** Faces

Several faces are defined; you can inspect them with ~M-x
describe-face~ or override them in your theme.

- ~thattem-mode-line/bright~
- ~thattem-mode-line/dark~
- ~thattem-mode-line/error~

** Format

The default header-line and mode-line formats are stored in
~thattem-default-header-line-format~ and
~thattem-default-mode-line-format~. You can replace them with your own
list of mode-line constructs.

Specialized formats for shell-like buffers, help buffers, and EAF
buffers are also provided; you can modify
~thattem-shell-header-line-format~, ~thattem-help-header-line-format~,
etc.

** Buffer-Local Style

Each buffer can have a numeric ‚Äústyle‚Äù (stored in
~thattem-mode-line--buffer-style~) that switches between alternative
faces (e.g., ~bright-2~, ~dark-2~). Use this to highlight specific
buffers.

* üñ±Ô∏è Mouse & Key Bindings

All interactive elements have their own keymaps. The most useful mouse
actions are:

| Element             | Mouse-1                    | Mouse-2       | Mouse-3                | Wheel                     |
|---------------------+----------------------------+---------------+------------------------+---------------------------|
| Buffer name         | ‚Äì                          | ‚Äì             | copy buffer name       | previous/next buffer      |
| Major mode          | local minor-mode menu      | describe mode | global minor-mode menu | ‚Äì                         |
| Project name        | open project root in Dired | ‚Äì             | ‚Äì                      | previous/next project buf |
| Directory component | open Dired at that dir     | ‚Äì             | sub-directory menu     | scroll path               |
| Flymake counter     | ‚Äì                          | ‚Äì             | ‚Äì                      | scroll diagnostics        |
| Line number         | ‚Äì                          | ‚Äì             | ‚Äì                      | previous/next line        |
| Column number       | ‚Äì                          | ‚Äì             | ‚Äì                      | backward/forward char     |

* ‚öôÔ∏è Customization Examples

** Changing the Separator Icons

The small-elements file defines the separator variables (cups, slants,
fire). You can replace them with any nerd-icons Powerline icon by
editing ~thattem-mode-line-small-elements.el~, or simply shadow the
variables in your init file:

#+begin_src elisp
  (setq thattem-mode-line-left-cup
        '(:eval (nerd-icons-powerline
                 "nf-ple-left_half_circle"
                 :face (thattem-mode-line/edge-face-when-active)
                 :height 1.25)))
#+end_src

** Adding a Clock

The package already provides ~thattem-mode-line-current-time~. To
include it, add it to your custom format:

#+begin_src elisp
  (setq thattem-default-mode-line-format
        (append thattem-default-mode-line-format
                '(thattem-mode-line-current-time)))
#+end_src

** Creating a New Style

Define new color sets and faces, then set
~thattem-mode-line--buffer-style~ to a number that matches the suffix
(e.g., style = 3 looks for faces ~bright-3~, ~dark-3~, etc.). See
~thattem-mode-line-faces.el~ for how the face-switch functions work.

* ü§ù Contributing

Contributions are welcome! Please open issues or pull requests on
[[https://github.com/thattemperature/thattem-mode-line][GitHub]].

** Development

The code is split into focused files:

- ~thattem-mode-line.el~ ‚Äì main entry point, minor-mode definition,
  hook setup.
- ~thattem-mode-line-small-elements.el~ ‚Äì decorative separators.
- ~thattem-mode-line-big-elements.el~ ‚Äì functional components (buffer
  name, major mode, project, Flymake, directory path, clock).
- ~thattem-mode-line-faces.el~ ‚Äì face definitions and face-switch
  functions.
- ~thattem-mode-line-colors.el~ ‚Äì customizable color variables.
- ~thattem-mode-line-keymaps.el~ ‚Äì mouse-and-wheel keymaps for each
  interactive element.
- ~thattem-mode-line-helper-functions.el~ ‚Äì helper functions for
  directory scrolling, Flymake counting, wrapper macros, etc.
- ~thattem-mode-line-window-actions.el~ ‚Äì display-buffer-alist entries
  for consistent window placement.

When adding a new element, follow the existing pattern: define a
buffer-local variable that evaluates to a propertized string, attach a
keymap and help-echo, and mark it as risky-local-variable.

* üìÑ License

Copyright ¬© 2025 That Temperature.

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or (at
your option) any later version.

This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the [[https://www.gnu.org/licenses/][GNU
General Public License]] for more details.

* üì£ Acknowledgments

- [[https://github.com/rainstormstudio/nerd-icons.el][nerd-icons]] for the beautiful icon set.
- [[https://github.com/bbatsov/projectile][projectile]] for project-aware navigation.
- [[https://github.com/flymake/flymake][flymake]] for on-the-fly diagnostics.
- The Emacs community for inspiration and feedback.
