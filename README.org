#+TITLE: thattem-mode-line
#+AUTHOR: That Temperature
#+EMAIL: 2719023332@qq.com
#+LANGUAGE: en
#+OPTIONS: toc:t num:nil
#+HTML: <a href=\"https://www.gnu.org/licenses/gpl-3.0\"><img src=\"https://img.shields.io/badge/license-GPL%20v3-blue.svg\" alt=\"License: GPL v3\"></a>
#+HTML: <a href=\"https://www.gnu.org/software/emacs/\"><img src=\"https://img.shields.io/badge/Emacs-%3E%3D30.1-%237F5AB6\" alt=\"Emacs â‰¥ 30.1\"></a>
#+HTML: <a href=\"https://github.com/thattemperature/thattem-mode-line\"><img src=\"https://img.shields.io/badge/GitHub-thattem--mode--line-181717\" alt=\"GitHub\"></a>

* ğŸŒˆ A Beautiful, Interactive Modeâ€‘Line for Emacs

[[https://github.com/thattemperature/thattem-mode-line][thattem-mode-line]] replaces the default Emacs modeâ€‘line and headerâ€‘line
with a modern, visually rich design that combines aesthetic appeal
with practical productivity.  Built with [[https://github.com/rainstormstudio/nerd-icons.el][nerd-icons]] and featuring a
fullâ€‘color, themeâ€‘aware palette, it transforms your Emacs into a
polished, interactive workspace.

* âœ¨ Features

** Decorative Elements
- Halfâ€‘circle â€œcupsâ€, triangular â€œslantsâ€, and flame icons as
  Powerlineâ€‘style separators.
- All icons are drawn with nerdâ€‘icons and adapt to the active/inactive
  window state.

** Interactive Components

*** Buffer Name
- Click to copy the buffer name to the killâ€‘ring.
- Mouseâ€‘wheel scroll to cycle through previous/next buffers.
- Fileâ€‘type icon (when the buffer is visiting a file).

*** Majorâ€‘Mode Area
- Mouseâ€‘1: popâ€‘up menu of active /local/ minor modes.
- Mouseâ€‘2: describe the current major mode.
- Mouseâ€‘3: popâ€‘up menu of active /global/ minor modes.

*** Project Name (requires [[https://github.com/bbatsov/projectile][projectile]])
- Mouseâ€‘1: open the projectâ€™s root directory in Dired.
- Mouseâ€‘wheel: cycle through project buffers.

*** Directory Path
- Each path component is a clickable button that opens Dired at that
  directory.
- Mouseâ€‘3 on a component shows a menu of its subâ€‘directories.
- Mouseâ€‘wheel scrolls the path horizontally when it overflows.

*** Flymake Diagnostics
- Error, warning, and note counters with distinct colors.
- Mouseâ€‘wheel scrolls through the diagnostics of each type.

*** Line & Column Numbers
- Mouseâ€‘wheel scrolls lines (up/down) and characters (left/right).

** Theme Support
- Separate, customizable color sets for light and dark themes.
- Inactive windows automatically switch to a subdued palette.
- Faces are defined so you can easily tweak the colors via
  ~customize~.

** Smart Layouts
- /Shellâ€‘like buffers/ (term, shell, eshell) get a special headerâ€‘line
  with flame separators and a reduced font size.
- /Help buffers/ show only line/column numbers and a slant separator.
- /EAF buffers/ use the default format.
- The modeâ€‘line adapts to window width: some elements (e.g., detailed
  Flymake icons) appear only when the window is wide enough.

* ğŸ“¦ Requirements

- Emacs â‰¥ 30.1
- [[https://github.com/rainstormstudio/nerd-icons.el][nerd-icons]]
- [[https://github.com/bbatsov/projectile][projectile]] (optional, for project name)
- [[https://github.com/flymake/flymake][flymake]] (optional, for diagnostics)
- [[https://github.com/rejeep/dash.el][dash]]
- [[https://github.com/rejeep/f.el][f]]

* ğŸ”§ Installation

** Manual Installation

Clone the repository:

#+begin_src sh
  git clone https://github.com/thattemperature/thattem-mode-line.git
#+end_src

Add to your ~load-path~ and require the package:

#+begin_src elisp
  (add-to-list 'load-path "/path/to/thattem-mode-line")
  (require 'thattem-mode-line)
#+end_src

Then enable the global minor mode:

#+begin_src elisp
  (thattem-mode-line-mode 1)
#+end_src

** Using ~straight.el~ or ~quelpa~

If you use a package manager that supports Git sources, you can
install directly from the repository.

Example with ~straight.el~:

#+begin_src elisp
  (straight-use-package '(thattem-mode-line
                          :type git
                          :host github
                          :repo "thattemperature/thattem-mode-line"))
  (thattem-mode-line-mode 1)
#+end_src

* ğŸ¨ Configuration

All customizable options are under the ~thattemâ€‘modeâ€‘line~ group. To
change them, use ~Mâ€‘x customizeâ€‘group RET thattemâ€‘modeâ€‘line RET~ or
set them in your init file.

** Colors

The package defines four color variables â€“ two for light themes, two
for dark themes â€“ that control the background and foreground of the
modeâ€‘line.

- ~thattemâ€‘modeâ€‘line/lightâ€‘theme/brightâ€‘color~
- ~thattemâ€‘modeâ€‘line/lightâ€‘theme/darkâ€‘color~
- ~thattemâ€‘modeâ€‘line/darkâ€‘theme/brightâ€‘color~
- ~thattemâ€‘modeâ€‘line/darkâ€‘theme/darkâ€‘color~

** Faces

Several faces are defined; you can inspect them with ~Mâ€‘x
describeâ€‘face~ or override them in your theme.

- ~thattemâ€‘modeâ€‘line/bright~
- ~thattemâ€‘modeâ€‘line/dark~
- ~thattemâ€‘modeâ€‘line/error~

** Format

The default headerâ€‘line and modeâ€‘line formats are stored in
~thattemâ€‘defaultâ€‘headerâ€‘lineâ€‘format~ and
~thattemâ€‘defaultâ€‘modeâ€‘lineâ€‘format~. You can replace them with your own
list of modeâ€‘line constructs.

Specialized formats for shellâ€‘like buffers, help buffers, and EAF
buffers are also provided; you can modify
~thattemâ€‘shellâ€‘headerâ€‘lineâ€‘format~, ~thattemâ€‘helpâ€‘headerâ€‘lineâ€‘format~,
etc.

** Bufferâ€‘Local Style

Each buffer can have a numeric â€œstyleâ€ (stored in
~thattemâ€‘modeâ€‘lineâ€‘â€‘bufferâ€‘style~) that switches between alternative
faces (e.g., ~brightâ€‘2~, ~darkâ€‘2~). Use this to highlight specific
buffers..

* ğŸ–±ï¸ Mouse & Key Bindings

All interactive elements have their own keymaps.  The most useful
mouse actions are:

| Element             | Mouseâ€‘1                    | Mouseâ€‘2       | Mouseâ€‘3                | Wheel                     |
|---------------------+----------------------------+---------------+------------------------+---------------------------|
| Buffer name         | â€“                          | â€“             | copy buffer name       | previous/next buffer      |
| Major mode          | local minorâ€‘mode menu      | describe mode | global minorâ€‘mode menu | â€“                         |
| Project name        | open project root in Dired | â€“             | â€“                      | previous/next project buf |
| Directory component | open Dired at that dir     | â€“             | subâ€‘directory menu     | scroll path               |
| Flymake counter     | â€“                          | â€“             | â€“                      | scroll diagnostics        |
| Line number         | â€“                          | â€“             | â€“                      | previous/next line        |
| Column number       | â€“                          | â€“             | â€“                      | backward/forward char     |

* âš™ï¸ Customization Examples

** Changing the Separator Icons

The smallâ€‘elements file defines the separator variables (cups, slants,
fire).  You can replace them with any nerdâ€‘icons Powerline icon by
editing ~thattemâ€‘modeâ€‘lineâ€‘smallâ€‘elements.el~, or simply shadow the
variables in your init file:

#+begin_src elisp
  (setq thattem-mode-line-left-cup
        '(:eval (nerd-icons-powerline
                 "nf-ple-left_half_circle"
                 :face (thattem-mode-line/edge-face-when-active)
                 :height 1.25)))
#+end_src

** Adding a Clock

The package already provides ~thattemâ€‘modeâ€‘lineâ€‘currentâ€‘time~.  To
include it, add it to your custom format:

#+begin_src elisp
  (setq thattem-default-mode-line-format
        (append thattem-default-mode-line-format
                '(thattem-mode-line-current-time)))
#+end_src

** Creating a New Style

Define new color sets and faces, then set
~thattemâ€‘modeâ€‘lineâ€‘â€‘bufferâ€‘style~ to a number that matches the suffix
(e.g., style = 3 looks for faces ~brightâ€‘3~, ~darkâ€‘3~, etc.).  See
~thattemâ€‘modeâ€‘lineâ€‘faces.el~ for how the faceâ€‘switch functions work.

* ğŸ¤ Contributing

Contributions are welcome!  Please open issues or pull requests on
[[https://github.com/thattemperature/thattem-mode-line][GitHub]].

** Development

The code is split into focused files:

- ~thattemâ€‘modeâ€‘line.el~ â€“ main entry point, minorâ€‘mode definition,
  hook setup.
- ~thattemâ€‘modeâ€‘lineâ€‘smallâ€‘elements.el~ â€“ decorative separators.
- ~thattemâ€‘modeâ€‘lineâ€‘bigâ€‘elements.el~ â€“ functional components (buffer
  name, major mode, project, Flymake, directory path, clock).
- ~thattemâ€‘modeâ€‘lineâ€‘faces.el~ â€“ face definitions and faceâ€‘switch
  functions.
- ~thattemâ€‘modeâ€‘lineâ€‘colors.el~ â€“ customizable color variables.
- ~thattemâ€‘modeâ€‘lineâ€‘keymaps.el~ â€“ mouseâ€‘andâ€‘wheel keymaps for each
  interactive element.
- ~thattemâ€‘modeâ€‘lineâ€‘helperâ€‘functions.el~ â€“ helper functions for
  directory scrolling, Flymake counting, wrapper macros, etc.
- ~thattemâ€‘modeâ€‘lineâ€‘windowâ€‘actions.el~ â€“ displayâ€‘bufferâ€‘alist entries
  for consistent window placement.

When adding a new element, follow the existing pattern: define a
bufferâ€‘local variable that evaluates to a propertized string, attach a
keymap and helpâ€‘echo, and mark it as riskyâ€‘localâ€‘variable.

* ğŸ“„ License

Copyright Â© 2025 That Temperature.

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or (at
your option) any later version.

This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the [[https://www.gnu.org/licenses/][GNU
General Public License]] for more details.

* ğŸ“£ Acknowledgments

- [[https://github.com/rainstormstudio/nerd-icons.el][nerd-icons]] for the beautiful icon set.
- [[https://github.com/bbatsov/projectile][projectile]] for projectâ€‘aware navigation.
- [[https://github.com/flymake/flymake][flymake]] for onâ€‘theâ€‘fly diagnostics.
- The Emacs community for inspiration and feedback.
